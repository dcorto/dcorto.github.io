<!-- inject:../components/baseHead/baseHeadStart.html -->
<!DOCTYPE html>
<html lang="{{- $.Lang }}">
  <head>
    {{ partial "head.html" . }} {{ partial "head_custom.html" . }}
  </head>

  <body>
    {{ partial "header.html" . }}

    <section
      id="blog-single"
      class="section section--border-bottom rad-animation-group flex-grow-1"
    >
      <div id="main-content" class="container">
        <h1><a href="{{ .RelPermalink }}">{{ .Title }}</a></h1>

        <aside id="meta" class="light-border-bottom">
          <div>
            <section>
              {{ i18n "published_on" }}&nbsp;
              <h4 id="date">{{ .Date | time.Format ":date_full" }}</h4> · <h4 id="wordcount">{{ .WordCount }} {{ i18n "words" }}</h4>
            </section>
            {{ with .GetTerms "topics" }}
            <ul id="topics">
              {{ range . }}
              <li><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></li>
              {{ end }}
            </ul>
            {{ end }} {{ with .GetTerms "tags" }}
            <ul class="tags">
              {{ range . }}
              <li><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></li>
              {{ end }}
            </ul>
            {{ end }}
          </div>
        </aside>

        <div class="row flex-column-reverse flex-md-row rad-fade-down light-border-bottom">
          <div class="col-12">{{ .Content | safeHTML }}</div>
        </div>

        <aside class="content-browser">
          <div class="giscus"></div>
        </aside>

        <aside class="content-browser light-border-top">
            {{ i18n "continue_reading" }}
            <div>
                {{ with .PrevInSection }}
                    <a class="previous" href="{{ .RelPermalink }}">↩ {{ .LinkTitle }}</a>
                {{ end }}
                 ■ 
                {{ with .NextInSection }}
                    <a class="next" href="{{ .RelPermalink }}"> {{ .LinkTitle }} ↪</a>
                {{ end }}
            </div>
        </aside>
      </div>
    </section>

    {{ partial "footer.html" . }} {{ partial "base-foot.html" . }}
    <!-- giscus script -->
    <script src="https://giscus.app/client.js"
            data-repo="dcorto/dcorto.github.io"
            data-repo-id="R_kgDONYP2jA"
            data-category="Blog"
            data-category-id="DIC_kwDONYP2jM4Cvp0C"
            data-mapping="title"
            data-strict="1"
            data-reactions-enabled="1"
            data-emit-metadata="1"
            data-input-position="top"
            data-theme="light"
            data-lang="es"
            data-loading="lazy"
            crossorigin="anonymous"
            async>
    </script>
    <script>
      /**
       * Sincroniza el tema de Giscus con el tema del blog (claro/oscuro).
       */
      (function() {
        // Función para enviar un mensaje al iframe de Giscus para cambiar su tema.
        function setGiscusTheme(theme) {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (iframe) {
            console.log("hello iframe " + theme)
            
            iframe.contentWindow.postMessage({ giscus: { setConfig: { theme: theme } } }, 'https://giscus.app');
          }
        }

        // Función que determina el tema actual del blog y se lo comunica a Giscus.
        function syncGiscusTheme() {
          const newTheme = document.documentElement.getAttribute('data-bs-theme');
          console.log(newTheme + " > new theme")
          setGiscusTheme(newTheme);
        }

        // Esperamos a que Giscus cargue y cree su iframe.
        // Usamos un MutationObserver en el contenedor '.giscus' para ello.
        const giscusContainer = document.querySelector('.giscus');
        if (giscusContainer) {
          new MutationObserver((mutations, observer) => {
            const giscusIframe = document.querySelector('iframe.giscus-frame');
            if (giscusIframe) {
              // El iframe existe, pero su contenido de 'https://giscus.app' puede no estar cargado aún.
              // Esperamos al evento 'load' para asegurar que el origen del iframe es el correcto antes de enviar mensajes.
              giscusIframe.addEven
              tListener('load', () => {
                // Ahora que el iframe está completamente cargado, establecemos el tema inicial.
                // Añadimos un pequeño retardo (50ms) para dar tiempo al script interno de Giscus
                // a inicializar su listener de mensajes, aumentando la fiabilidad.
                setTimeout(() => {
                  syncGiscusTheme();
                }, 1000);

                // Y ahora observamos cambios en el tema del blog para mantener Giscus sincronizado.
                new MutationObserver(syncGiscusTheme).observe(document.documentElement, { attributes: true, attributeFilter: ['data-bs-theme'] });
              });

              // Dejamos de observar el contenedor de giscus, ya no es necesario.
              observer.disconnect();
            }
          }).observe(giscusContainer, { childList: true });
        }
      })();
    </script>
  </body>
</html>
<!-- endinject -->
